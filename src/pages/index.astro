---
import BaseLayout from "@/layouts/BaseLayout.astro";
import HeroSlider, { slideData } from "@/components/react/HeroSlider";
import EditorialIntro from "@/components/astro/EditorialIntro.astro";
import EmbracedBySeaSlider, { seaFeatures } from "@/components/react/EmbracedBySeaSlider";
import FusionCuisineSlider, { dishes } from "@/components/react/FusionCuisineSlider";
import { getResponsiveImage } from "@/utils/responsive-images";

const title = "Villa Boutique Hotel El Ensueño by the Beach — Zihuatanejo Ixtapa Mexico | Official Site";
const description =
  "Like the home of an art collector, El Ensueño is an intimate four-suite boutique hotel set directly on the sandy beach of La Ropa, offering refined service, privacy, and a relaxed sense of understated luxury.";
const heroPaths = slideData.map((slide) => slide.src);
const heroImages = await Promise.all(
  heroPaths.map((path, index) =>
    getResponsiveImage(path, {
      widths: [640, 960, 1366, 1600, 1920],
      sizes: "100vw",
      priority: index === 0,
    }),
  ),
);
const heroImageMap = Object.fromEntries(
  heroPaths.map((path, index) => [path, heroImages[index]]),
);

const cuisinePaths = dishes.map((dish) => dish.image);
const cuisineImages = await Promise.all(
  cuisinePaths.map((path) =>
    getResponsiveImage(path, {
      widths: [480, 768, 1024, 1280],
      sizes: "(min-width: 1024px) 45vw, 80vw",
    }),
  ),
);
const cuisineImageMap = Object.fromEntries(
  cuisinePaths.map((path, index) => [path, cuisineImages[index]]),
);

const seaPaths = seaFeatures.map((feature) => feature.url);
const seaImages = await Promise.all(
  seaPaths.map((path) =>
    getResponsiveImage(path, {
      widths: [480, 768, 1024, 1280],
      sizes: "(min-width: 1024px) 25vw, 80vw",
    }),
  ),
);
const seaImageMap = Object.fromEntries(
  seaPaths.map((path, index) => [path, seaImages[index]]),
);

const ogImage = heroImageMap[heroPaths[0]].src;
const preloadImages = [heroImageMap[heroPaths[0]].src];
const siteUrl = Astro.site ?? "https://www.el-ensueno.com";
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Hotel",
  name: "El Ensueño",
  url: siteUrl,
  description,
  telephone: "+52 755 554 2222",
  image: heroPaths.slice(0, 3).map((path) => new URL(heroImageMap[path].src, siteUrl).toString()),
  address: {
    "@type": "PostalAddress",
    streetAddress: "Playa La Ropa S/N",
    addressLocality: "Zihuatanejo",
    addressRegion: "Guerrero",
    postalCode: "40880",
    addressCountry: "MX",
  },
  geo: {
    "@type": "GeoCoordinates",
    latitude: 17.6398,
    longitude: -101.5548,
  },
  amenityFeature: [
    { "@type": "LocationFeatureSpecification", name: "Plunge pools", value: true },
    { "@type": "LocationFeatureSpecification", name: "Infinity pool", value: true },
    { "@type": "LocationFeatureSpecification", name: "Palapa beach lounge", value: true },
    { "@type": "LocationFeatureSpecification", name: "Meal plans available", value: true },
  ],
  sameAs: ["https://www.tripadvisor.com/ShowUserReviews-g150795-d152932-r121555894-La_Casa_Que_Canta-Zihuatanejo_Pacific_Coast.html"],
};
---

<BaseLayout
  title={title}
  description={description}
  ogImage={ogImage}
  preloadImages={preloadImages}
  structuredData={structuredData}
  currentLang="en"
>
  <script is:inline>
    if (window.location.hash && window.location.hash.startsWith("#contact")) {
      window.location.replace("/contact");
    }
  </script>
  <section id="home" class="relative h-screen">
    <HeroSlider lang="en" images={heroImageMap} client:visible />
  </section>

  <EditorialIntro id="maison" lang="en" />

  <FusionCuisineSlider lang="en" images={cuisineImageMap} client:visible />

  <EmbracedBySeaSlider lang="en" images={seaImageMap} client:visible />
</BaseLayout>
