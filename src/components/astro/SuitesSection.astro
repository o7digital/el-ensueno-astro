---
import { slugify } from "@/utils/slugify";
import { suites as suitesData } from "@/data/suites";
import { getResponsiveImage } from "@/utils/responsive-images";

interface Props {
  id?: string;
}

const { id } = Astro.props as Props;

const suites = suitesData.map((suite) => ({
  title: suite.title,
  image: suite.heroImage,
  description: suite.description,
  size: suite.size,
  guests: suite.guests,
}));

const suiteImageMap = Object.fromEntries(
  await Promise.all(
    suites.map(async (suite) => [
      suite.image,
      await getResponsiveImage(suite.image, {
        widths: [320, 480, 640],
        sizes: "(min-width: 1024px) 25vw, 50vw",
      }),
    ]),
  ),
);
---

<section id={id} class="py-16 sm:py-20 lg:py-28 bg-sand">
  <div class="max-w-7xl mx-auto px-6">
    <div class="text-center mb-12">
      <p class="text-sm uppercase tracking-[0.14em] text-dusk/70 mb-4">Our Suites</p>
      <h2 class="text-4xl sm:text-5xl lg:text-6xl font-serif text-dusk">Where Comfort Meets Elegance</h2>
      <p class="mt-4 text-lg text-ink/80 max-w-2xl mx-auto">
        Each suite is carefully designed to provide an unforgettable stay experience
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      {suites.map((suite) => {
        const image = suiteImageMap[suite.image];
        return (
          <a
            href={`/suites/${slugify(suite.title)}`}
            class="group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300"
          >
            <div class="aspect-[3/4] relative overflow-hidden">
              <img
                src={image.src}
                alt={suite.title}
                class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                loading="lazy"
                decoding={image.decoding ?? "async"}
                srcset={image.srcSet}
                sizes={image.sizes}
                width={image.width}
                height={image.height}
              />
              <div class="absolute inset-0 bg-gradient-to-t from-ink/80 via-ink/20 to-transparent opacity-90"></div>
            </div>
            <div class="absolute bottom-0 left-0 right-0 p-6">
              <div class="h-14 mb-2 flex items-end">
                <h3 class="text-lg font-serif text-white line-clamp-2">{suite.title}</h3>
              </div>
              <div class="flex gap-4 text-sm text-white/90 mb-3">
                <span>{suite.size}</span>
                <span>•</span>
                <span>{suite.guests}</span>
              </div>
              <p class="text-sm text-white/90 line-clamp-2">{suite.description}</p>
              <div class="mt-4 inline-flex items-center gap-2 text-sm font-semibold text-amber-400 group-hover:gap-3 transition-all">
                View Details
                <span>→</span>
              </div>
            </div>
          </a>
        );
      })}
    </div>
  </div>
</section>
