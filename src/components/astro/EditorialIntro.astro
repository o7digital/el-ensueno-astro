---
import AboutSlider, { aboutImages } from "@/components/react/AboutSlider";
import { useTranslations } from "@/i18n/ui";
import { getResponsiveImage } from "@/utils/responsive-images";

interface Props {
  id?: string;
  lang?: 'en' | 'es';
}

const { id, lang = 'en' } = Astro.props as Props;
const t = useTranslations(lang);
const aboutImageMap = Object.fromEntries(
  await Promise.all(
    aboutImages.map(async (path, index) => [
      path,
      await getResponsiveImage(path, {
        widths: [640, 960, 1280, 1536, 1720],
        sizes: "(min-width: 1920px) 1280px, (min-width: 1024px) 66vw, 100vw",
        priority: index === 0,
      }),
    ]),
  ),
);

const aboutParagraphs = lang === 'es'
  ? [
      t('about.description'),
      'A su llegada, los huéspedes son recibidos bajo una amplia palapa tradicional con vista a la bahía, donde la gran alberca y las vistas abiertas al mar marcan de inmediato el tono. Cómodos sofás para leer o descansar, un bar discreto y generosas zonas de sombra invitan a bajar el ritmo y sintonizar con la costa.',
      'Sobre el mar, la terraza con camastros ofrece un sitio privilegiado para relajarse todo el día, mientras que los atardeceres se disfrutan mejor en la palapa lounge frente a la playa. Planes de comida personalizados y cocina local preparada por nuestro chef completan la experiencia, con un esmero cuidadoso en cada detalle para nuestros huéspedes.',
      'El Ensueño es un lugar para desconectarse, disfrutar largas siestas en una de las suites con plunge pool, cenar junto al mar y vivir la elegante tranquilidad de un hotel boutique diseñado para la intimidad y el descanso.',
    ]
  : [
      t('about.description'),
      'Upon arrival, guests are welcomed beneath a vast traditional palapa overlooking the bay, where the large swimming pool and the open views of the sea immediately set the tone. Comfortable reading and sleeping sofas, a discreet bar, and generous shaded areas invite guests to slow down and settle into the rhythm of the coast.',
      'Above the sea, the sunbed terrace provides a privileged spot to relax throughout the day, while sunsets are best enjoyed at the palapa beach lounge. Personalized meal plans and local cuisine prepared by our chef complete the experience, with thoughtful care given to every detail for our house guests.',
      'El Ensueño is a place to unwind, enjoy long siestas in one of the plunge-pool suites, dine by the sea, and experience the quiet elegance of a boutique hotel designed for tranquility and intimacy.',
    ];

const features = lang === 'es'
  ? [
      'Servicio todo incluido',
      'Bebidas premium',
      'Chef privado y servicio de mayordomo incluidos',
      'Alberca infinita de 100 m³',
      'Bar en la alberca y palapa',
      'Wi-Fi de cortesía',
      'Estacionamiento privado',
    ]
  : [
      'All-inclusive service',
      'Premium drinks',
      'Private chef and butler service included',
      '100 m³ infinity pool',
      'Pool & palapa bar',
      'Complimentary Wi-Fi',
      'Private parking',
    ];
---

<section id={id} class="relative overflow-hidden">
  <!-- Version Mobile/Tablet : empilement vertical -->
  <div class="lg:hidden">
    <!-- Texte en haut -->
    <div class="bg-sand px-6 py-12 sm:px-8 sm:py-16">
      <div class="max-w-2xl mx-auto space-y-4 sm:space-y-6">
        <h1 class="text-xl sm:text-2xl uppercase tracking-[0.10em] text-dusk font-semibold">{t('about.title')}</h1>
        <h2 class="text-3xl leading-[1.05] sm:text-4xl md:text-5xl font-serif text-dusk">
          {t('about.intro')}
        </h2>
        <div class="space-y-4">
          {aboutParagraphs.map((paragraph) => (
            <p class="text-base sm:text-lg leading-relaxed text-ink/80">{paragraph}</p>
          ))}
        </div>
      </div>
    </div>
    
    <!-- Slider en bas avec hauteur fixe -->
    <div class="relative h-[500px] sm:h-[600px]">
      <AboutSlider lang={lang} images={aboutImageMap} client:visible />
    </div>
  </div>

  <!-- Version Desktop : côte à côte -->
  <div class="hidden lg:mx-auto lg:grid lg:max-w-[1920px] lg:grid-cols-[1fr,2fr] lg:h-screen lg:min-h-[700px]">
    <!-- Texte à gauche -->
    <div class="relative flex items-center bg-sand px-12">
      <div class="w-full space-y-6">
        <h1 class="text-2xl uppercase tracking-[0.10em] text-dusk font-semibold">{t('about.title')}</h1>
        <h2 class="text-5xl xl:text-6xl leading-[1.05] font-serif text-dusk">
          {t('about.intro')}
        </h2>
        <div class="space-y-4">
          {aboutParagraphs.map((paragraph) => (
            <p class="text-lg leading-relaxed text-ink/80">{paragraph}</p>
          ))}
        </div>
      </div>
    </div>

    <!-- Slider à droite -->
    <div class="relative h-full">
      <AboutSlider lang={lang} images={aboutImageMap} client:visible />
    </div>
  </div>
</section>

<!-- Features -->
<section class="bg-sand text-ink py-12 sm:py-14 lg:py-16">
  <div class="max-w-6xl mx-auto px-6 sm:px-8">
    <h3 class="text-center text-2xl sm:text-3xl uppercase tracking-[0.10em] text-dusk font-semibold mb-8 sm:mb-10">
      {t('about.featuresTitle')}
    </h3>
    <div class="flex flex-wrap lg:flex-nowrap items-center justify-center gap-4 sm:gap-6 lg:gap-10">
      {features.map((item) => (
        <div class="text-lg sm:text-xl font-medium text-center leading-tight whitespace-nowrap">{item}</div>
      ))}
    </div>
  </div>
</section>
